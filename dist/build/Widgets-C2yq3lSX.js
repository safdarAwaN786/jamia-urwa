import{cb as N,a as x,j as t,ak as S,z as y,b as A,ac as B,l as F,m as P,w as z,y as p,g as b,ad as q,q as m,ae as H,I as O,ag as U,J as G,r as _,cc as K,M as j}from"./strapi-DszYkmQ4.js";import{W as u}from"./WidgetHelpers-BUkbtlOQ.js";const Q=N.enhanceEndpoints({addTagTypes:["RecentDocumentList"]}).injectEndpoints({overrideExisting:!0,endpoints:e=>({getRecentDocuments:e.query({query:s=>`/content-manager/homepage/recent-documents?action=${s.action}`,transformResponse:s=>s.data,providesTags:(s,o,{action:i})=>[{type:"RecentDocumentList",id:i}]})})}),{useGetRecentDocumentsQuery:v}=Q,D="14.4rem",E=(e=4)=>{const i=14.4*e/4;return`${Math.round(i*10)/10}rem`},$=j(m)`
  display: block;
  max-width: ${({$maxWidth:e})=>e||D};
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,R=({documents:e,type:s,dynamicMaxWidth:o=D})=>{const{formatMessage:i}=x(),{trackUsage:r}=A(),c=B(),g=a=>{const h=a.kind==="singleType",n=h?"single-types":"collection-types",d=a.locale?`?plugins[i18n][locale]=${a.locale}`:"";return`/content-manager/${n}/${a.contentTypeUid}${h?"":"/"+a.documentId}${d}`},f=a=>()=>{r("willEditEntryFromHome",{entryType:s});const h=g(a);c(h)};return t.jsx(F,{colCount:5,rowCount:e?.length??0,children:t.jsx(P,{children:e?.map(a=>t.jsxs(z,{onClick:f(a),cursor:"pointer",children:[t.jsx(p,{children:t.jsx($,{title:a.title,variant:"omega",textColor:"neutral800",$maxWidth:o,children:a.title})}),t.jsx(p,{children:t.jsx($,{variant:"omega",textColor:"neutral600",$maxWidth:o,children:a.kind==="singleType"?i({id:"content-manager.widget.last-edited.single-type",defaultMessage:"Single-Type"}):i({id:a.contentTypeDisplayName,defaultMessage:a.contentTypeDisplayName})})}),t.jsx(p,{children:t.jsx(b,{display:"inline-block",children:a.status?t.jsx(q,{status:a.status}):t.jsx(m,{textColor:"neutral600","aria-hidden":!0,children:"-"})})}),t.jsx(p,{children:t.jsx(m,{textColor:"neutral600",children:t.jsx(H,{timestamp:new Date(a.updatedAt)})})}),t.jsx(p,{onClick:h=>h.stopPropagation(),children:t.jsx(b,{display:"inline-block",children:t.jsx(O,{tag:U,to:g(a),onClick:()=>r("willEditEntryFromHome",{type:s}),label:i({id:"content-manager.actions.edit.label",defaultMessage:"Edit"}),variant:"ghost",children:t.jsx(G,{})})})})]},a.documentId))})})},tt=({columnWidth:e=6})=>{const{formatMessage:s}=x(),{data:o,isLoading:i,error:r}=v({action:"update"}),c=E(e);return i?t.jsx(u.Loading,{}):r||!o?t.jsx(u.Error,{}):o.length===0?t.jsx(u.NoData,{children:s({id:"content-manager.widget.last-edited.no-data",defaultMessage:"No edited entries"})}):t.jsx(R,{documents:o,type:"edited",dynamicMaxWidth:c})},et=({columnWidth:e=6})=>{const{formatMessage:s}=x(),{data:o,isLoading:i,error:r}=v({action:"publish"}),c=E(e);return i?t.jsx(u.Loading,{}):r||!o?t.jsx(u.Error,{}):o.length===0?t.jsx(u.NoData,{children:s({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})}):t.jsx(R,{documents:o,type:"published",dynamicMaxWidth:c})},l=80,w=10,C=2*Math.PI*(l-w/2),V=j.circle`
  stroke: ${({theme:e,$arcColor:s})=>e.colors[s]};
`,k=j.tspan`
  text-transform: lowercase;
  fill: ${({theme:e,$textColor:s})=>e.colors[s]};
`,X=j(y)`
  width: 100%;

  ${({theme:e})=>e.breakpoints.small} {
    width: auto;
  }
`,J=({data:e})=>{const{locale:s}=x(),{formatMessage:o}=x(),i=e.reduce((n,d)=>n+d.count,0),[r,c]=_.useState({visible:!1,x:0,y:0,value:null});let g=0;const f=(n,d)=>{c({visible:!0,x:n.clientX,y:n.clientY,value:d})},a=()=>{c(n=>({...n,visible:!1}))},h=(n,d)=>{c({visible:!0,x:n.currentTarget.getBoundingClientRect().width/2+n.currentTarget.getBoundingClientRect().left,y:n.currentTarget.getBoundingClientRect().height+n.currentTarget.getBoundingClientRect().top,value:d})};return t.jsxs(y,{direction:"column",gap:6,margin:"auto",children:[t.jsxs("svg",{width:l*2,height:l*2,viewBox:`0 0 ${l*2} ${l*2}`,style:{position:"relative",zIndex:1},children:[t.jsx("g",{transform:`rotate(-90 ${l} ${l})`,children:e.map(n=>{const d=n.count/i*100,T=d/100*C,W=`${T} ${C-T}`,L=C*(1-g/100),I=t.jsx(V,{cx:l,cy:l,r:l-w/2,fill:"none",strokeWidth:w,strokeDasharray:W,strokeDashoffset:L,style:{transition:"stroke-dashoffset 0.3s",cursor:"pointer"},tabIndex:0,"aria-describedby":r.visible?"chart-tooltip":void 0,onFocus:M=>h(M,n),onBlur:a,onMouseMove:M=>f(M,n),onMouseLeave:a,$arcColor:n.color},n.label);return g+=d,I})}),t.jsxs("text",{x:l,y:l,textAnchor:"middle",fontSize:"2.4rem",fontWeight:"bold",children:[t.jsx(k,{x:l,dy:"0",$textColor:"neutral800",children:new Intl.NumberFormat(s,{notation:"compact",maximumFractionDigits:1}).format(i)}),t.jsx(k,{x:l,dy:"1.4em",fontSize:"1.4rem",fontWeight:"normal",$textColor:"neutral600",children:o({id:"content-manager.widget.chart-entries.count.label",defaultMessage:"{count, plural, =0 {entries} one {entry} other {entries}}"},{count:i})})]})]}),r.visible&&r.value&&t.jsx(K,{style:{position:"fixed",left:16,top:16,zIndex:2,transform:`translate(${r.x}px, ${r.y}px)`},"data-testid":"entries-chart-tooltip",children:t.jsx(b,{background:"neutral900",padding:2,borderRadius:1,textAlign:"center",role:"tooltip","aria-live":"polite",children:t.jsx(m,{textColor:"neutral0",children:o({id:"content-manager.widget.chart-entries.tooltip",defaultMessage:"{count} items"},{count:r.value.count,label:r.value.label})})})}),t.jsx(y,{gap:4,wrap:"wrap",children:e.map(n=>n.count>0&&t.jsxs(X,{gap:1,children:[t.jsx(b,{background:n.color,padding:2,borderRadius:1}),t.jsx(m,{variant:"pi",children:n.label})]},n.label))})]})},nt=()=>{const{formatMessage:e}=x(),{data:s,isLoading:o,error:i}=S();if(o)return t.jsx(u.Loading,{});if(i)return t.jsx(u.Error,{});const{draft:r,published:c,modified:g}=s??{draft:0,published:0,modified:0};return r+c+g?t.jsx(y,{minHeight:"100%",children:t.jsx(J,{data:[{label:e({id:"content-manager.containers.List.draft",defaultMessage:"Draft"}),count:r,color:"secondary500"},{label:e({id:"content-manager.containers.List.modified",defaultMessage:"Modified"}),count:g,color:"alternative500"},{label:e({id:"content-manager.containers.List.published",defaultMessage:"Published"}),count:c,color:"success500"}]})}):t.jsx(u.NoData,{children:e({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})})};export{nt as ChartEntriesWidget,tt as LastEditedWidget,et as LastPublishedWidget};
